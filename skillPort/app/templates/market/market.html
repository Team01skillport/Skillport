{% extends "base.html" %} 

{# === ãƒšãƒ¼ã‚¸ã®ã‚¿ã‚¤ãƒˆãƒ« === #}
{% block title %}ãƒãƒ¼ã‚±ãƒƒãƒˆ{% endblock %} 

{# === ãƒšãƒ¼ã‚¸å›ºæœ‰ã®CSS === #}
{% block styles %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/market.css') }}" />
{% endblock %} 

{# === ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ === #}
{% block content %}
<main class="main-content">
  <div class="main-container">
    <h2 class="page-title">ãƒãƒ¼ã‚±ãƒƒãƒˆ</h2>

    <div class="content-wrapper">
      
      <aside class="sidebar">
        
        <div class="sidebar-title">
          <span>çµã‚Šè¾¼ã¿</span>
          <span class="filter-icon">â¬‡</span>
        </div>

        <button class="filter-btn active">æ›´æ–°</button>

        <div class="filter-section" id="categoryFilter">
          <button class="filter-item toggle-filter-btn">
            <span>ã‚«ãƒ†ã‚´ãƒªãƒ¼</span><span class="arrow">ï¼</span>
          </button>
          
          {# 
            !!! å¤‰æ›´ !!!
            ID ã‚’ "categoryList" ã‹ã‚‰ "categoryListContainer" ã«å¤‰æ›´
            ã‚¯ãƒ©ã‚¹ã‚’ "subcategory-list" ã‹ã‚‰ "filter-list-container" ã«å¤‰æ›´
          #}
          <div class="filter-content filter-list-container" id="categoryListContainer" style="display: none;">
            </div>
        </div>

        <div class="filter-section" id="statusFilter">
          <button class="filter-item toggle-filter-btn">
            <span>è²©å£²çŠ¶æ³</span><span class="arrow">ï¼</span>
          </button>
          <div class="filter-content" style="display: none;">
            <div class="filter-checkbox-group">
              <label>
                <input type="checkbox" name="sale_status" value="on_sale">
                è²©å£²ä¸­
              </label>
              <label>
                <input type="checkbox" name="sale_status" value="sold_out">
                å£²ã‚Šåˆ‡ã‚Œ
              </label>
            </div>
          </div>
        </div>
        
        <div class="filter-section" id="sellerFilter">
          <button class="filter-item toggle-filter-btn">
            <span>å‡ºå“è€…</span><span class="arrow">ï¼</span>
          </button>
          <div class="filter-content" style="display: none;">
            <p style="font-size: 14px; color: #888;">(æœªå®Ÿè£…)</p>
          </div>
        </div>

        <div class="filter-section" id="conditionFilter">
          <button class="filter-item toggle-filter-btn">
            <span>å•†å“ã®çŠ¶æ…‹</span><span class="arrow">ï¼</span>
          </button>
          <div class="filter-content" style="display: none;">
            <div class="filter-checkbox-group">
              <label><input type="checkbox" name="condition" value="new"> æ–°å“ã€æœªä½¿ç”¨</label>
              <label><input type="checkbox" name="condition" value="like_new"> æœªä½¿ç”¨ã«è¿‘ã„</label>
              <label><input type="checkbox" name="condition" value="good"> ç›®ç«‹ã£ãŸå‚·ã‚„æ±šã‚Œãªã—</label>
              <label><input type="checkbox" name="condition" value="fair"> ã‚„ã‚„å‚·ã‚„æ±šã‚Œã‚ã‚Š</label>
              <label><input type="checkbox" name="condition" value="poor"> å‚·ã‚„æ±šã‚Œã‚ã‚Š</label>
            </div>
          </div>
        </div>

        <div class="filter-section" id="priceFilter">
          <button class="filter-item toggle-filter-btn">
            <span>ä¾¡æ ¼</span><span class="arrow">ï¼</span>
          </button>
          <div class="filter-content price-filter-content" style="display: none;">
            <div class="price-inputs">
              <input type="number" placeholder="Â¥ Min" class="price-input" min="0">
              <span>-</span>
              <input type="number" placeholder="Â¥ Max" class="price-input" min="0">
            </div>
            <button class="btn-apply-price">é©ç”¨</button>
          </div>
        </div>
      </aside>

      <div class="products-area">
        <div class="products-header">
          <div class="search-bar">
            <span class="search-icon">ğŸ”</span>
            <input type="text" placeholder="æ¤œç´¢ãƒãƒ¼" class="product-search" />
          </div>
          <!--!ã“ã“ã‹ã‚‰ãƒ­ã‚°ã‚¤ãƒ³åˆ¤å®š  -->

          {% if 'user_id' in session %}
            <div class="action-buttons">
              <a href="{{ url_for('market.manage_products_page') }}" class="btn btn-green">
                <span class="btn-icon">â—</span> å‡ºå“ç®¡ç†
              </a>
              <button class="btn btn-yellow">
                <span class="btn-icon">â—</span> è³¼å…¥ç®¡ç†
              </button>
            </div>
          {% endif %}
        </div>

        <div class="product-grid" id="productGrid"></div>

        <button class="load-more">ã‚‚ã£ã¨è¦‹ã‚‹</button>
      </div>
    </div>
  </div>
</main>
{% endblock %} 

{# === ãƒšãƒ¼ã‚¸å›ºæœ‰ã®JS === #}
{% block scripts %}
  <script>
    /* ãªãœï¼Ÿ: JSãƒ•ã‚¡ã‚¤ãƒ« ã¯ 'url_for' ã‚’å®Ÿè¡Œã§ããªã„ãŸã‚ã€
              HTMLå´ã§Flaskã®ãƒ‘ã‚¹ã‚’ç”Ÿæˆã—ã€JSã«æ¸¡ã™å¿…è¦ãŒã‚ã‚‹ã€‚*/
    
    // 1. ç”»åƒãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹ 'static/media/' ãƒ•ã‚©ãƒ«ãƒ€ã¸ã®URL
    var STATIC_MEDIA_URL = "{{ url_for('static', filename='media/') }}";
    
    // 2. å•†å“è©³ç´°ãƒšãƒ¼ã‚¸ã®åŸºæœ¬URL (ä¾‹: /market/product/)
    var PRODUCT_DETAIL_URL_BASE = "{{ url_for('market.product_detail', product_id=0) }}".replace('0', '');
  </script>
  
  <script src="{{ url_for('static', filename='js/market.js') }}" defer></script>
{% endblock %}