{% extends "base.html" %} 
{% block title %}{{ info.product_name | default('å•†å“è©³ç´°', true) }}{% endblock %} 

{% block styles %}
<link
  rel="stylesheet"
  href="{{ url_for('static', filename='css/product_detail.css') }}"
/>
<link
  rel="stylesheet"
  href="{{ url_for('static', filename='css/popup_report.css') }}"
/>
<style>
  /* [æ–°å¢] ä¸ºæ²¡æœ‰å›¾ç‰‡çš„å ä½ç¬¦æ·»åŠ æ ·å¼ */
  .dummy-main-image {
    width: 100%;
    height: var(--main-img, 440px);
    display: flex;
    align-items: center;
    justify-content: center;
    background: #f8f8f8;
    border: 1.5px solid #ccc;
    border-radius: 10px;
    font-size: 1.5rem;
    color: #aaa;
    flex-direction: column;
  }
</style>
{% endblock %} 

{% block content %}
<div class="page-wrap">
  <main class="product-section">
    
    <div class="image-area">
      <div class="thumbnails">
        
        {% if info.image_path %}
        <img
          src="{{ url_for('static', filename=info.image_path) }}"
          class="thumb active"
          alt="ã‚µãƒ ãƒã‚¤ãƒ«1"
        />
        {% endif %}
        
        {% for img in other_images %}
        <img
          src="{{ url_for('static', filename=img.image_path) }}"
          class="thumb"
          alt="ã‚µãƒ ãƒã‚¤ãƒ«{{ loop.index + 1 }}"
        />
        {% endfor %}

      </div>
      <div class="main-image">
        
        {% if info.image_path %}
        <img
          id="mainImage"
          src="{{ url_for('static', filename=info.image_path) }}"
          alt="ãƒ¡ã‚¤ãƒ³å•†å“ç”»åƒ"
        />
        {% else %}
          <div class="dummy-main-image">
            <span>?</span>
            <p style="font-size: 1rem; margin-top: 10px;">ç”»åƒãŒã‚ã‚Šã¾ã›ã‚“</p>
          </div>
        {% endif %}
        
      </div>
    </div>
    <div class="info-area">
      <h1>{{info.product_name}}</h1>
      <p class="price">Â¥{{info.product_price}}(ç¨è¾¼)</p>

      <div class="action-buttons">
        <a href="#" class="btn">â™¡ ãŠæ°—ã«å…¥ã‚Š</a>
        <a href="#" class="btn">ğŸ’¬ ã‚³ãƒ¡ãƒ³ãƒˆ</a>
        <a href="#" class="btn">ğŸ“© é€£çµ¡</a>
        <a href="#" class="btn" id="reportBtn">é€šå ±</a>
      </div>

      <a href="{{ url_for('market.checkout_page', product_id=info.product_id) }}" class="buy-btn">è³¼å…¥</a>

      <div class="desc">
        <h2>å•†å“ã®èª¬æ˜</h2>
        <p>{{info.product_description}}</p>
      </div>

      <div class="detail">
        <h2>å•†å“ã®æƒ…å ±</h2>
        <ul>
          <li>å•†å“ã®çŠ¶æ…‹ï¼š<b>{{info.product_condition}}</b></li>
          <li>é…é€å…ƒã®åœ°åŸŸï¼š<b>{{info.shipping_area}}</b></li>
        </ul>
      </div>
    </div>
  </main>

  <section class="bottom-section">
    <div class="comment-box">
      <button class="comment-btn">ã‚³ãƒ¡ãƒ³ãƒˆæŠ•ç¨¿</button>
      <h3>ã‚³ãƒ¡ãƒ³ãƒˆä¸€è¦§</h3>
      <ul>
        <li>
          <img
            src="{{ url_for('static', filename='media/profile_icon.png') }}"
            alt=""
          />
          <div class="bubble">ãµãµã¯ã¯</div>
        </li>
      </ul>
    </div>
    <div class="seller-box">
      <h3>å‡ºå“è€…</h3>
      <div class="seller-info">
        {% if info.seller_icon %}
          <img src="{{ url_for('static', filename=info.seller_icon[1:]) }}" alt="å‡ºå“è€…ã‚¢ã‚¤ã‚³ãƒ³">
        {% else %}
          <img src="{{ url_for('static', filename='media/profile_icon.png') }}" alt="ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¢ã‚¤ã‚³ãƒ³">
        {% endif %}
        <div class="text">
          <h4><a href="#">{{ info.seller_name }}</a></h4>
          <p>{{ info.seller_tags }}</p>
          <p>â­ï¸â­ï¸â­ï¸â­ï¸â˜† (è©•ä¾¡ã¯å¾Œã§å®Ÿè£…)</p>
        </div>
        <a href="#" class="follow-btn">ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹</a>
      </div>
    </div>
  </section>
</div>

<div id="reportModal" class="modal hidden">
  <div class="modal-content">
    <h2>é€šå ±</h2>
    <form id="reportForm">
      <label
        ><input type="radio" name="reason" value="ä¸é©åˆ‡" />
        å…¬åºè‰¯ä¿—ã«åã™ã‚‹å†…å®¹ã‚’å«ã‚€</label
      ><br />
      <label
        ><input type="radio" name="reason" value="é•æ³•å•†å“" />
        é•æ³•ãƒ»ç¦æ­¢å•†å“ã®å‡ºå“</label
      ><br />
      <label
        ><input type="radio" name="reason" value="è‘—ä½œæ¨©ä¾µå®³" />
        è‘—ä½œæ¨©ãƒ»å•†æ¨™æ¨©ã®ä¾µå®³</label
      ><br />
      <label
        ><input type="radio" name="reason" value="è™šå½" /> å•†å“èª¬æ˜ãŒè™šå½</label
      ><br />
      <label><input type="radio" name="reason" value="ãã®ä»–" /> ãã®ä»–</label
      ><br />
      <textarea
        name="detail"
        rows="4"
        placeholder="è©³ç´°å†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"
      ></textarea>
      <div class="modal-buttons">
        <button type="button" id="closeModal">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        <button type="submit" id="submitReport">å ±å‘Š</button>
      </div>
    </form>
  </div>
</div>
{% endblock %}

{% block scripts %}
  <script src="{{ url_for('static', filename='js/product_detail.js') }}" defer></script>
  <script src="{{ url_for('static', filename='js/popup_report.js') }}" defer></script>
{% endblock %}