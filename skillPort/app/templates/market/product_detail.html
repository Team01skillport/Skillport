{% extends "base.html" %} {% block title %}{{ info.product_name |
default('商品詳細', true) }}{% endblock %} {% block styles %}
<link
  rel="stylesheet"
  href="{{ url_for('static', filename='css/product_detail.css') }}"
/>
<link
  rel="stylesheet"
  href="{{ url_for('static', filename='css/popup_report.css') }}"
/>
<style>
  /* [新增] 为没有图片的占位符添加样式 */
  .dummy-main-image {
    width: 100%;
    height: var(--main-img, 440px);
    display: flex;
    align-items: center;
    justify-content: center;
    background: #f8f8f8;
    border: 1.5px solid #ccc;
    border-radius: 10px;
    font-size: 1.5rem;
    color: #aaa;
    flex-direction: column;
  }
</style>
{% endblock %} {% block content %}
<div class="page-wrap">
  <main class="product-section">
    <div class="image-area">
      <div class="thumbnails">
        {% if info.image_path %}
        <img
          src="{{ url_for('static', filename=info.image_path) }}"
          class="thumb active"
          alt="サムネイル1"
        />
        {% endif %} {% for img in other_images %}
        <img
          src="{{ url_for('static', filename=img.image_path) }}"
          class="thumb"
          alt="サムネイル{{ loop.index + 1 }}"
        />
        {% endfor %}
      </div>
      <div class="main-image">
        {% if info.image_path %}
        <img
          id="mainImage"
          src="{{ url_for('static', filename=info.image_path) }}"
          alt="メイン商品画像"
        />
        {% else %}
        <div class="dummy-main-image">
          <span>?</span>
          <p style="font-size: 1rem; margin-top: 10px">画像がありません</p>
        </div>
        {% endif %}
      </div>
    </div>
    <div class="info-area">
      <h1>{{info.product_name}}</h1>
      <p class="price">¥{{info.product_price}}(税込)</p>

      <div class="action-buttons">
        <a href="#" class="btn">♡ お気に入り</a>
        <a href="#" class="btn" id="reportBtn">通報</a>
      </div>

      <a
        href="{{ url_for('market.checkout_page', product_id=info.product_id) }}"
        class="buy-btn"
        >購入</a
      >

      <div class="desc">
        <h2>商品の説明</h2>
        <p>{{info.product_description}}</p>
      </div>

      <div class="detail">
        <h2>商品の情報</h2>
        <ul>
          <li>商品の状態：<b>{{info.product_condition}}</b></li>
          <li>配送元の地域：<b>{{info.shipping_area}}</b></li>
        </ul>
      </div>
    </div>
  </main>

  <section class="bottom-section">
    <div class="comment-box">
      <button class="comment-btn">コメント投稿</button>
      <h3>コメント一覧</h3>
      <ul>
        <li>
          <img
            src="{{ url_for('static', filename='media/profile_icon.png') }}"
            alt=""
          />
          <div class="bubble">ふふはは</div>
        </li>
      </ul>
    </div>
    <div class="seller-box">
      <h3>出品者</h3>
      <div class="seller-info">
        {% if info.seller_icon %}
        <img
          src="{{ url_for('static', filename='media/user' + uploader_data.profile_icon) }}"
          alt="出品者アイコン"
        />
        {% else %}
        <img
          src="{{ url_for('static', filename='media/profile_icon.png') }}"
          alt="デフォルトアイコン"
        />
        {% endif %}
        <div class="text">
          <h4>
            <a href="{{url_for('auth.view_profile', user_id=uploader_id)}}"
              >{{ info.seller_name }}</a
            >
          </h4>
          <div class="user_rating">
            {% for star in rating_stars %}
            <p>{{star}}</p>
            {% endfor %}
          </div>
        </div>
      </div>
    </div>
  </section>
</div>

<div id="reportModal" class="modal hidden">
  <div class="modal-content">
    <h2>通報</h2>
    <form id="reportForm">
      <label
        ><input type="radio" name="reason" value="不適切" />
        公序良俗に反する内容を含む</label
      ><br />
      <label
        ><input type="radio" name="reason" value="違法商品" />
        違法・禁止商品の出品</label
      ><br />
      <label
        ><input type="radio" name="reason" value="著作権侵害" />
        著作権・商標権の侵害</label
      ><br />
      <label
        ><input type="radio" name="reason" value="虚偽" /> 商品説明が虚偽</label
      ><br />
      <label><input type="radio" name="reason" value="その他" /> その他</label
      ><br />
      <textarea
        name="detail"
        rows="4"
        placeholder="詳細内容を入力してください"
      ></textarea>
      <div class="modal-buttons">
        <button type="button" id="closeModal">キャンセル</button>
        <button type="submit" id="submitReport">報告</button>
      </div>
    </form>
  </div>
</div>
{% endblock %} {% block scripts %}
<script
  src="{{ url_for('static', filename='js/product_detail.js') }}"
  defer
></script>
<script
  src="{{ url_for('static', filename='js/popup_report.js') }}"
  defer
></script>
{% endblock %}
