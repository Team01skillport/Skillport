{% extends "base.html" %}

{% block title %}
商品管理 - SkillPort
{% endblock %}

{% block styles %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/product_management.css') }}">
  
  <style>
    .no-products-message {
      grid-column: 1 / -1; 
      text-align: center;
      padding: 60px 20px;
      background-color: #f9f9f9;
      border-radius: 12px;
      border: 1px dashed #ddd;
      margin-top: 20px;
      color: #555;
    }
    .no-products-message p {
      margin: 10px 0;
      font-size: 1rem;
    }
    .no-products-message p.lead {
      font-size: 1.2rem;
      font-weight: 600;
      color: #333;
    }
    .badge.sold {
      background-color: #9ca3af; 
    }
    .dummy-thumb {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        width: 100%;
        height: 100%;
        background-color: #f0f2f5;
        color: #9ca3af;
        text-align: center;
    }
    .dummy-thumb span {
        font-size: 2rem;
        font-weight: bold;
    }
    .dummy-thumb p {
        font-size: 0.8rem;
        margin-top: 8px;
        padding: 0 10px;
    }
  </style>
{% endblock %}


{% block content %}
  <main class="pmain">
    <div class="pcontainer">
      <h2 class="page-title">商品管理</h2>

      <div class="toolbar">
        <a href="{{ url_for('market.create_product_page') }}" class="pill blue">新規商品登録</a>
      </div>

      <section class="grid">

        {% if my_products %}
          {% for product in my_products %}
          <article class="card">
            <a href="{{url_for('market.product_detail', product_id=product.product_id)}}">
              <div class="thumb">
                
                {% if product.image_path %}
                  <img src="{{ url_for('static', filename=product.image_path) }}" alt="{{ product.product_name }}">
                {% else %}
                  <div class="dummy-thumb">
                    <span>?</span>
                    <p>{{ product.product_name | truncate(20) }}</p>
                  </div>
                {% endif %}
                </div>
              <div class="product-details">
                <h5>{{product.product_name}}</h5>
                <p>￥{{product.product_price}}</p>
              </div>
              <div class="ops">
                {% if product.sales_status == 'S' %}
                  <span class="badge">出品中</span>
                {% elif product.sales_status == 'C' %}
                  <span class="badge sold">売切</span>
                {% else %}
                  <span class="badge gray">不明</span>
                {% endif %}

                <a href="{{ url_for('market.edit_product_page', product_id=product.product_id) }}" class="ghost-sm">編集</a>
              </div>
            </a>
          </article>
          {% endfor %}

        {% else %}
          <div class="no-products-message">
            <p class="lead">出品中の商品がありません</p>
            <p>「新規商品登録」ボタンから、最初の商品を登録してみましょう！</p>
          </div>
        {% endif %}

      </section>
      </main>
{% endblock %}